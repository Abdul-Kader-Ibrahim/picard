{
  "summary": "Downsample a SAM or BAM file to retain a subset of the reads based on the reads location in each tile in the flowcell.",
  "arguments": [
    {
      "summary": "Allow Downsampling again despite this being a bad idea with possibly unexpected results.",
      "name": "--ALLOW_MULTIPLE_DOWNSAMPLING_DESPITE_WARNINGS",
      "synonyms": "-",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Compression level for all compressed files created (e.g. BAM and GELI).",
      "name": "--COMPRESSION_LEVEL",
      "synonyms": "-",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "5",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Whether to create a BAM index when writing a coordinate-sorted BAM file.",
      "name": "--CREATE_INDEX",
      "synonyms": "-",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Whether to create an MD5 digest for any BAM or FASTQ files created.  ",
      "name": "--CREATE_MD5_FILE",
      "synonyms": "-",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "The (approximate) fraction of reads to be kept, between 0 and 1.",
      "name": "--FRACTION",
      "synonyms": "-F",
      "type": "Double",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "required",
      "options": []
    },
    {
      "summary": "Google Genomics API client_secrets.json file path.",
      "name": "--GA4GH_CLIENT_SECRETS",
      "synonyms": "-",
      "type": "String",
      "required": "no",
      "fulltext": "",
      "defaultValue": "client_secrets.json",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "The input SAM or BAM file to downsample.",
      "name": "--INPUT",
      "synonyms": "-I",
      "type": "File",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "required",
      "options": []
    },
    {
      "summary": "When writing SAM files that need to be sorted, this will specify the number of records stored in RAM before spilling to disk. Increasing this number reduces the number of file handles needed to sort a SAM file, and increases the amount of RAM needed.",
      "name": "--MAX_RECORDS_IN_RAM",
      "synonyms": "-",
      "type": "Integer",
      "required": "no",
      "fulltext": "",
      "defaultValue": "500000",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "The output, downsampled, SAM or BAM file.",
      "name": "--OUTPUT",
      "synonyms": "-O",
      "type": "File",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "required",
      "options": []
    },
    {
      "summary": "Whether to suppress job-summary info on System.err.",
      "name": "--QUIET",
      "synonyms": "-",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Regular expression that can be used to parse read names in the incoming SAM file. Read names are parsed to extract three variables: tile/region, x coordinate and y coordinate. The x and y coordinates are used to determine the downsample decision. Set this option to null to disable optical duplicate detection, e.g. for RNA-seq The regular expression should contain three capture groups for the three variables, in order. It must match the entire read name. Note that if the default regex is specified, a regex match is not actually done, but instead the read name  is split on colon character. For 5 element names, the 3rd, 4th and 5th elements are assumed to be tile, x and y values. For 7 element names (CASAVA 1.8), the 5th, 6th, and 7th elements are assumed to be tile, x and y values.",
      "name": "--READ_NAME_REGEX",
      "synonyms": "-",
      "type": "String",
      "required": "no",
      "fulltext": "",
      "defaultValue": "\u003coptimized capture of last three \u0027:\u0027 separated fields as numeric values\u003e",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Reference sequence file.",
      "name": "--REFERENCE_SEQUENCE",
      "synonyms": "-R",
      "type": "File",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Determines whether the duplicate tag should be reset since the downsampling requires re-marking duplicates.",
      "name": "--REMOVE_DUPLICATE_INFORMATION",
      "synonyms": "-",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "true",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Stop after processing N reads, mainly for debugging.",
      "name": "--STOP_AFTER",
      "synonyms": "-",
      "type": "Long",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "One or more directories with space available to be used by this program for temporary storage of working files",
      "name": "--TMP_DIR",
      "synonyms": "-",
      "type": "List[File]",
      "required": "no",
      "fulltext": "",
      "defaultValue": "[]",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Use the JDK Deflater instead of the Intel Deflater for writing compressed output",
      "name": "--USE_JDK_DEFLATER",
      "synonyms": "-use_jdk_deflater",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Use the JDK Inflater instead of the Intel Inflater for reading compressed input",
      "name": "--USE_JDK_INFLATER",
      "synonyms": "-use_jdk_inflater",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Validation stringency for all SAM files read by this program.  Setting stringency to SILENT can improve performance when processing a BAM file in which variable-length data (read, qualities, tags) do not otherwise need to be decoded.",
      "name": "--VALIDATION_STRINGENCY",
      "synonyms": "-",
      "type": "ValidationStringency",
      "required": "no",
      "fulltext": "",
      "defaultValue": "STRICT",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": [
        {
          "summary": "",
          "name": "STRICT"
        },
        {
          "summary": "",
          "name": "LENIENT"
        },
        {
          "summary": "",
          "name": "SILENT"
        }
      ]
    },
    {
      "summary": "Control verbosity of logging.",
      "name": "--VERBOSITY",
      "synonyms": "-",
      "type": "LogLevel",
      "required": "no",
      "fulltext": "",
      "defaultValue": "INFO",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": [
        {
          "summary": "",
          "name": "ERROR"
        },
        {
          "summary": "",
          "name": "WARNING"
        },
        {
          "summary": "",
          "name": "INFO"
        },
        {
          "summary": "",
          "name": "DEBUG"
        }
      ]
    }
  ],
  "description": "\u003ch4\u003eSummary\u003c/h4\u003e\n Class to downsample a SAM/BAM file based on the position of the read in a flowcell. As with DownsampleSam, all the\n reads with the same queryname are either kept or dropped as a unit.\n \u003cp/\u003e\n\n \u003ch4\u003eDetails\u003c/h4\u003e\n The downsampling is \u003cb\u003enot\u003c/b\u003e random (and there is no random seed). It is deterministically determined by the position\n of each read within its \"tile\". Specifically, it draws an ellipse that covers a #FRACTION of the total tile\u0027s\n area and of all the edges of the tile. It uses this area to determine whether to keep or drop the record. Since reads\n with the same name have the same position (mates, secondary and supplemental alignments), the decision will be the\n same for all of them. The main concern of this downsampling method is that due to \"optical duplicates\" downsampling\n randomly can create a result that has a different optical duplciate rate, and therefore a different estimated library\n size (when running mark-duplicates) THe downsampling method done keeps (physically) close reads together, so that (except\n for the reads near the boundary of the circle) optical duplicates are kept or dropped as a group.\n\n By default the program expects the read names to have 5 or 7 fields separated by colons (:) and it takes the last two\n to indicate the x and y coordinates of the reads within the \"tile\" from whence it was sequenced. See\n ReadNameParser#DEFAULT_READ_NAME_REGEX for more detail. The program traverses the #INPUT twice. First\n to find out the size of each of the tiles, and next to perform the downsampling.\n\n Downsampling invalidates the duplicate flag (as reads marked as duplicates prior to downsampling might not be duplicates\n afterwards.) Thus, the default setting also removes the duplicate information.\n\n\u003ch4\u003eExample\u003c/h4\u003e\n \u003cpre\u003e\n java -jar picard.jar PositionBasedDownsampleSam \\\\\n       I\u003dinput.bam \\\\\n       O\u003ddownsampled.bam \\\\\n       FRACTION\u003d0.1\n \u003chr/\u003e\n \u003c/pre\u003e\n\u003ch4\u003eCaveats\u003c/h4\u003e\n\n Note 1:\n This method is \u003cb\u003etechnology and read-name dependent\u003c/b\u003e. If the read-names do not have coordinate information\n embedded in them, or if your BAM contains reads from multiple technologies (flowcell versions, sequencing machines)\n this will not work properly. It has been designed to work with Illumina MiSeq/HiSeq technology and reads-names. Consider\n modifying #READ_NAME_REGEX in other cases.\n \u003cp/\u003e\n Note 2:\n The code has been designed to simulate, as accurately as possible, sequencing less, \u003cb\u003enot\u003c/b\u003e for getting an exact\n downsampled fraction (Use DownsampleSam for that.) In particular, since the reads may be distributed non-evenly\n within the lanes/tiles, the resulting downsampling percentage will not be accurately determined by the input argument\n #FRACTION.\n \u003cp/\u003e\n Note 3:\n Consider running MarkDuplicates after downsampling in order to \"expose\" the duplicates whose representative has\n been downsampled away.\n Note 4:\n Due to the way the downsampling it performed, it assumes a uniform distribution of reads in the flowcell. This is violated\n if one uses an input that was already downsampled with PositionBasedDownsampleSam. To guard against this, a\n PG record is placed in the header ouf the output and if the input is found to contain this record, the program will\n abort.",
  "name": "PositionBasedDownsampleSam",
  "group": "SAM/BAM"
}